<?xml version="1.0"?>
<launch>
    <arg name="rosbag"/>
    <arg name="bagFile_directory" default="$(find analysis_femern)/bags/$(arg rosbag)"/>
    <arg name="rviz" default="true"/>
    <arg name="just_video_pointcloud" default="true"/>
    <arg name="replay_rate_factor" default="0.1"/>

    <arg name="start_paused" default="true"/>
        <arg if="$(eval start_paused == true)" name="pause_arg" value="--pause"/>
        <arg if="$(eval start_paused == false)" name="pause_arg" value=""/>

    <arg name="looped" default="true"/>
        <arg if="$(eval looped == true)" name="loop_arg" value="-l"/>
        <arg if="$(eval looped == false)" name="loop_arg" value=""/>

    <arg name="start_time" value="35" doc="time in seconds"/>
    <arg name="duration" value="10"  doc="time in seconds"/>

    <arg if="$(eval just_video_pointcloud == false)" name="rviz_config" value="config.rviz"/>
    <arg if="$(eval just_video_pointcloud == true)" name="rviz_config" value="video_pointcloud.rviz"/>

    <node 
        pkg="rosbag" type="play" name="player" output="screen"
        args="--clock $(arg loop_arg) --start $(arg start_time) --duration=$(arg duration) -r $(arg replay_rate_factor) $(arg pause_arg) $(arg bagFile_directory)"
        >
    </node>

    <!-- Rviz -->
    <node if="$(arg rviz)" pkg="rviz" type="rviz" name="rviz" args="-d $(find analysis_femern)/config/$(arg rviz_config)" output="log"/>

    <node pkg="nodelet" type="nodelet" name="nodelet_manager" args="manager" />

    <node pkg="nodelet" type="nodelet" name="nodelet1"
            args="load depth_image_proc/point_cloud_xyz nodelet_manager">
        <remap from="camera_info" to="/camera/depth/camera_info"/>
        <remap from="image_rect" to="/camera/depth/image_rect_raw"/>
        <remap from="points" to="/camera/depth/points"/>
    </node>

</launch>